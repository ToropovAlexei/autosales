ТЗ: Веб‑панель продавца (MVP, минимальная версия)

Цель: предоставить продавцу простейший интерфейс для управления товарами и категориями. Минимальный дизайн, только базовые функции.

1. Авторизация

Страница входа с формой Email + Пароль.

Кнопка «Войти» → запрос в API (POST /auth/login), в ответ приходит JWT.

JWT хранится в localStorage/sessionStorage, прикрепляется к каждому запросу.

После входа → редирект в панель.

2. Панель продавца
   Основная навигация (меню)

Категории

Товары

Выход (удаление JWT, возврат на страницу логина)

2.1 Категории

Таблица категорий: ID, Название.

Действия:

Добавить категорию (форма: название).

Редактировать название.

Удалить категорию.

API:

GET /categories

POST /categories

PUT /categories/{id}

DELETE /categories/{id}

2.2 Товары

Таблица товаров: ID, Название, Категория, Цена, Остаток.

Действия:

Добавить товар (форма: название, категория, цена, остаток).

Редактировать товар (те же поля).

Удалить товар.

API:

GET /products

POST /products

PUT /products/{id}

DELETE /products/{id}

2.3 Минимальные требования к UI

Использовать базовые таблицы и формы (React + Tailwind / shadcn/ui).

Без графиков, без сложного дизайна.

Всё в виде CRUD-таблиц.

3. Технические детали

Фреймворк: Next.js (React, TypeScript).

UI: Tailwind CSS + shadcn/ui (только готовые компоненты).

Структура:

/login — страница входа.

/categories — CRUD категорий.

/products — CRUD товаров.

Маршруты защищены: если нет JWT → редирект на /login.

Обработка ошибок: при 401/403 → выход и редирект на /login.

4. MVP‑ограничения

Нет регистрации продавцов (создаются вручную в БД).

Нет расширенных ролей (только продавец).

Нет фильтров/поиска.

Нет загрузки изображений (можно добавить позже).

Дизайн максимально простой (только таблицы/формы).

5. Критерии готовности

Продавец может войти по логину/паролю.

Может создавать, редактировать и удалять категории.

Может создавать, редактировать и удалять товары.

Интерфейс работает стабильно (без визуальных багов).

Взаимодействие с API полностью рабочее.

ТЗ: Telegram-бот (MVP)

Цель: предоставить покупателю минимальный интерфейс для просмотра каталога товаров и покупок за счёт пополненного баланса.

1. Основные функции

Регистрация пользователя по Telegram ID (автоматически при первом запуске).

Просмотр категорий товаров.

Просмотр товаров внутри категории.

Отображение цены товара.

Покупка товара из баланса.

Пополнение баланса через платёжного провайдера.

Просмотр текущего баланса.

2. Навигация в боте

Главное меню (кнопки):

Каталог

Пополнить баланс

Баланс

3. Сценарии пользователя
   3.1 Старт

Пользователь запускает бота (/start).

Создаётся учётная запись (user_id + баланс = 0).

Приветственное сообщение + кнопки меню.

3.2 Баланс

Пользователь нажимает «Баланс».

Бот показывает текущий баланс (например: «Ваш баланс: 500 ₽»).

3.3 Пополнение баланса

Пользователь нажимает «Пополнить баланс».

Бот предлагает выбрать сумму (кнопки 100 ₽, 500 ₽, 1000 ₽).

Создаётся платёж через API (POST /balance/deposit).

После успешного платежа приходит вебхук → API обновляет баланс.

Бот уведомляет: «Баланс пополнен на 500 ₽. Текущий баланс: 1000 ₽».

3.4 Каталог

Пользователь нажимает «Каталог».

Отправляется список категорий (GET /categories).

Пользователь выбирает категорию.

Отображаются товары внутри категории (GET /products?category_id=...).

Товар отображается как карточка: Название, Цена, кнопка «Купить».

3.5 Покупка товара

При нажатии «Купить» → бот вызывает POST /orders/buy-from-balance.

Проверка баланса:

Если хватает: баланс уменьшается, заказ создаётся, бот отвечает «Вы купили товар X за 500 ₽. Баланс: 500 ₽».

Если не хватает: бот пишет «Недостаточно средств. Пополните баланс».

4. Технические детали

Фреймворк: Python, aiogram.

Взаимодействие: все операции через API.

Авторизация: по Telegram user_id.

Хранение сессий: Redis.

Формат сообщений: Markdown/HTML, inline-кнопки.

Антиспам: защита от повторных кликов (обработка только первого).

5. Ограничения MVP

Нет истории заказов (только уведомление при покупке).

Нет поиска и фильтров по товарам.

Нет изображений товаров.

Только один способ пополнения (Stripe/YooKassa/crypto — выбрать окружением).

6. Критерии готовности

Пользователь может пополнить баланс.

Пользователь может просмотреть категории и товары.

Пользователь может купить товар за счёт баланса.

Бот корректно уведомляет о пополнении и покупке.

Все данные сохраняются через API.

ТЗ: API для связи панели и Telegram-бота (MVP)

Цель: обеспечить взаимодействие между Telegram-ботом и веб‑панелью продавца. Все данные (категории, товары, баланс, заказы) проходят через API.

1. Общие требования

Стиль: REST API (JSON).

Авторизация:

Для панели продавцов — JWT (логин/пароль).

Для бота — сервисный токен (секрет в заголовке).

Формат ответов: { "success": true/false, "data": ..., "error": ... }

Документация: Swagger / Redoc.

2. Основные сущности и эндпоинты
   2.1 Аутентификация (панель)

POST /auth/login → JWT

POST /auth/logout

2.2 Категории

GET /categories — список категорий.

POST /categories — создать категорию (название).

PUT /categories/{id} — обновить название.

DELETE /categories/{id} — удалить.

2.3 Товары

GET /products — список товаров (с фильтром по категории ?category_id=).

POST /products — создать товар (название, категория, цена, остаток).

PUT /products/{id} — обновить.

DELETE /products/{id} — удалить.

2.4 Пользователи (для бота)

POST /users/register — регистрация по Telegram ID.

GET /users/{id} — получить данные (баланс, user_id).

2.5 Баланс

GET /users/{id}/balance — получить баланс.

POST /balance/deposit — создать операцию пополнения (сумма, метод).

POST /balance/webhook — приём уведомлений от платёжного провайдера (успешная оплата → обновить баланс).

2.6 Заказы

POST /orders/buy-from-balance — покупка товара (user_id, product_id).

Проверка: если хватает средств → создать заказ, уменьшить баланс, вернуть успех.

Если не хватает → вернуть ошибку.

3. Модели данных (MVP)
   Категория
   {
   "id": 1,
   "name": "Категория 1"
   }
   Товар
   {
   "id": 10,
   "name": "Товар A",
   "category_id": 1,
   "price": 500,
   "stock": 20
   }
   Пользователь
   {
   "id": 100,
   "telegram_id": "123456789",
   "balance": 1000
   }
   Заказ
   {
   "id": 500,
   "user_id": 100,
   "product_id": 10,
   "amount": 500,
   "status": "success"
   }
4. Ограничения MVP

Нет истории заказов (кроме базовой записи).

Нет возвратов/отмен.

Один магазин / один бот.

Один метод пополнения (Stripe/YooKassa/crypto — выбрать окружением).

5. Критерии готовности

Панель может CRUD категорий и товаров через API.

Бот получает категории и товары через API.

Пользователь может пополнить баланс и купить товар.

Баланс корректно списывается/увеличивается.

Документация Swagger доступна по /docs.
